---
- !policy 
  id: jenkins/user-database/v1
  annotations:
    description: This policy declares secrets (via Conjur variables) which are available to Jenkins jobs located within the user-database Jenkins Folder.
  body:
    - !variable
      id: cloud/access_key_id
      annotations:
        description: User database Jenkins job api key to cloud service
    - !variable
      id: cloud/secret_access_key
      annotations:
        description: User database Jenkins job secret access key
    - !variable
      id: chef/private_key
      annotations:
        description: RSA key to authenticate with an external service
    - !group
      id: secret-managers
      annotations:
        description: Members are able to update the value of all secrets within the policy
    - !host
      id: jenkins-folder
      annotations:
        description: Host identity for running Jenkins jobs in user-database folder - can access user-database API keys
    - !permit
      role: !group secret-managers
      privilege:
        - execute 
        - update
      resource: !variable cloud/access_key_id
      resource: !variable cloud/secret_access_key
      resource: !variable chef/private_key
    - !permit
      role: !host jenkins-folder
      privilege: execute
      resource: !variable cloud/access_key_id
      resource: !variable cloud/secret_access_key
      resource: !variable chef/private_key
...