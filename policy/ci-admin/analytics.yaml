---
- !policy jenkins/analytics/v1
  - annotations:
    description: This policy declares secrets (via Conjur variables) which are available to Jenkins jobs located within the analytics Jenkins Folder.
  body:
  - !variable &access_key_id 
    - id: cloud/access_key_id
    - annotations:
        description: Analytics Jenkins job api key to cloud service
  - !variable &secret_access_key 
    - id: cloud/secret_access_key
    - annotations:
        description: Analytics Jenkins job secret access key
  - !variable &rsa_key 
    - id: rsa_key
  	- annotations:
  		description: RSA key to authenticate with an external service
  - !group &secret-managers 
    - id: secret-managers
    - annotations:
      description: Members are able to update the value of all secrets within the policy
  - !host &job
    - annotations:
      description: Host identity for running Jenkins jobs in analytics folder - can access analytics API keys
  - !permit
    role: *secret-managers
    privilege:
    - execute 
    - update
    resource: *access_key_id
  - !permit
    role: *secret-managers
    privilege: 
      - execute
      - update
    resource: *secret_access_key
  - !permit
    role: *secret-managers
    privilege: 
      - execute
      - update
    resource: *rsa_key
  - !permit
    role: *job
    privilege: execute
    resource: *access_key_id
  - !permit
    role: *job
    privilege: execute
    resource: *secret_access_key
  - !permit
    role: *job
    privilege: 
      - execute
    resource: *rsa_key
...